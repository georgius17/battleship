(this.webpackJsonpbattleship2=this.webpackJsonpbattleship2||[]).push([[0],{12:function(e,n,i){e.exports={shipPart:"Ship_shipPart__K8Gey",shipPartHovered:"Ship_shipPartHovered__uS5Mc",hoverShip:"Ship_hoverShip__35sgE",shipBody:"Ship_shipBody__N3a2H",X:"Ship_X__vlDYK",Y:"Ship_Y__2s760"}},2:function(e,n,i){e.exports={winner:"App_winner__30_-M",boardContainer:"App_boardContainer__2ZQPz",Container:"App_Container__10KOh",Disable:"App_Disable__du_WH",containerDisable:"App_containerDisable__3lxJj",DisableBtn:"App_DisableBtn__29Nii",buttonDisable:"App_buttonDisable__3luh_",gameContainer:"App_gameContainer__2NvQs",gameProperties:"App_gameProperties__1C3Qq",flipBtn:"App_flipBtn__2kiL2",startBtn:"App_startBtn__1bdxB",resetBtn:"App_resetBtn__14bY2"}},28:function(e,n,i){e.exports=i(35)},33:function(e,n,i){},35:function(e,n,i){"use strict";i.r(n);var t=i(0),r=i.n(t),a=i(22),o=i.n(a),s=(i(33),i(26)),l=i(16),c=i(5),p=i(2),h=i.n(p),u=i(4),d=i.n(u),f=i(38),m="ship_item",g=function(e){var n=Object(t.useState)(null),i=Object(c.a)(n,2),a=i[0],o=i[1],s=Object(f.a)({accept:m,collect:function(n){return{isOver:!!n.isOver(),canDrop:"grid"===e.type}},drop:function(n,i,t){return"grid"===e.type?e.dropped(n,a):null}}),l=Object(c.a)(s,2),p=(l[0].isOver,l[1]),h=e.grid.map((function(n){return"grid"===e.type?r.a.createElement("div",{ref:p,onDrop:function(){return o(n.index)},className:n.sunk?d.a.gridItemSunkShip:n.hit?[d.a.gridHittedItem,d.a[n.ship]].join(" "):n.ship?d.a.gridItemShip:d.a.gridItem,key:n.index}):"computer"===e.type?r.a.createElement("div",{className:n.sunk?d.a.gridItemSunkShip:n.hit?[d.a.gridHittedItem,d.a[n.ship]].join(" "):d.a.gridInvisibleItem,key:n.index,onClick:function(){return e.clicked(n.index)}}):void 0}));return r.a.createElement("div",{ref:p,className:d.a.gridContainer},h)},_=i(24),v=function(e){for(var n=[],i=0,t={0:[],1:[],2:[],3:[],4:[]},r=65;r<75;r++)for(var a=1;a<11;a++){var o={index:i,coordinates:String.fromCharCode(r)+a,hit:!1,ship:!1,sunk:!1};n.push(o),i++}return{getGrid:function(){return n},placeShips:function(e){for(var i="X"===e.ship.orientation?1:10,r=e.ship.firstIndex,a=0;a<e.ship.length;a++)n[r].ship=!0,t[e.ship.id].push(r),r+=i},freeIndexController:function(e,i,t,r){var a="X"===r?e%10:Math.floor(e/10);if(i<=a&&a<=10-t+i){for(var o="X"===r?1:10,s=e-i*o,l=0;l<t;l++){if(!0===n[s].ship)return!1;s+=o}return!0}return!1},duplicateAttackHandler:function(e){return!n[e].hit},aiAttackHandler:function(e){var i=[];e.forEach((function(e){if(e.ship.sunk)for(var t=e.ship.firstIndex,r="X"===e.ship.orientation?1:10,a=0;a<e.ship.length;a++)i.push(t),n[t].sunk=!0,t+=r}));var t,r=!0,a=null,o=null,s="Y",l=Object(_.a)(n);try{for(l.s();!(t=l.n()).done;){var c=t.value;if(c.hit&&c.ship&&!i.includes(n.indexOf(c))){r=!1;var p=n.indexOf(c);if(p>9)if(n[p-10].ship&&n[p-10].hit){s="Y";for(var h=p-10;h>0;){if(console.log(h),!1===n[h].hit){o=h;break}if(n[h].hit&&!n[h].ship)break;h-=10}}else n[p-10].hit||"Y"!==s||(a=p-10);if(p<90)if(n[p+10].ship&&n[p+10].hit){s="Y";for(var u=p+10;u<100;){if(console.log(u),!1===n[u].hit){o=u;break}if(n[u].hit&&!n[u].ship)break;u+=10}}else n[p+10].hit||"Y"!==s||(a=p+10);if(null===a&&(s="X"),p%10<9)if(n[p+1].ship&&n[p+1].hit){s="X";for(var d=p+1;d%10<10&&d%10>0;){if(console.log(d),!1===n[d].hit){o=d;break}if(n[d].hit&&!n[d].ship)break;d+=1}}else n[p+1].hit||"X"!==s||(a=p+1);if(p%10>0)if(n[p-1].ship&&n[p-1].hit){s="X";for(var f=p-1;f%10!==-1;){if(console.log(f),!1===n[f].hit){o=f;break}if(n[f].hit&&!n[f].ship)break;f-=1}}else n[p-1].hit||"X"!==s||(a=p-1);break}}}catch(g){l.e(g)}finally{l.f()}if(null!==o)return o;if(null===o&&null!==a)return a;if(r||null===o&&null===a){for(var m=Math.floor(100*Math.random());n[m].hit;)m=Math.floor(100*Math.random());return m}},attackHandler:function(e){if(n[e].hit=!0,!n[e].ship)return!1;for(var i in t)if(t[i].includes(e))return i},checkSunkedShips:function(e){e.forEach((function(e){if(e.ship.sunk)for(var i=e.ship.firstIndex,t="X"===e.ship.orientation?1:10,r=0;r<e.ship.length;r++)n[i].sunk=!0,i+=t}))}}},S=function(e){var n=[{name:"carrier",length:5,YIndex:"A1",XIndex:"A1"},{name:"battleship",length:4,YIndex:"A3",XIndex:"B1"},{name:"cruiser",length:3,YIndex:"A5",XIndex:"C1"},{name:"submarine",length:3,YIndex:"A7",XIndex:"D1"},{name:"destroyer",length:2,YIndex:"A9",XIndex:"E1"}],i={name:n[e].name,length:n[e].length,placed:!1,sunk:!1,hit:0,firstIndex:n[e].YIndex,orientation:"Y",id:e},t=function(){i.hit===i.length&&(i.sunk=!0)};return{ship:i,flipShip:function(){i.orientation="X"===i.orientation?"Y":"X"},hitShip:function(){i.hit=i.hit+1,t()}}},b=i(12),y=i.n(b),k=i(39),I=function(e){var n=[],i=Object(t.useState)(null),a=Object(c.a)(i,2),o=a[0],s=a[1],l=Object(k.a)({item:{type:m,id:o},collect:function(e){return{isDragging:!!e.isDragging()}}}),p=Object(c.a)(l,2),h=(p[0].isDragging,p[1]);if(!e.ship)return null;for(var u=0;u<e.ship.ship.length;u++)n.push({id:e.ship.ship.name[2]+u});var d=n.map((function(e){return r.a.createElement("div",{onMouseEnter:function(){return s(e.id)},onMouseLeave:function(){return s(null)},className:o===e.id?y.a.shipPartHovered:y.a.shipPart,key:e.id})}));return r.a.createElement("div",{className:[y.a.shipBody,y.a[e.ship.ship.orientation]].join(" "),ref:h},d)},E=i(37),B=i(25);var P=function(){var e=Object(t.useCallback)((function(){for(var e=[],n=0;n<5;n++)e.push(S(n));return e})),n=Object(t.useState)({isPlaying:!1,activePlayer:null,winner:null}),i=Object(c.a)(n,2),a=i[0],o=i[1],p=Object(t.useState)({playerBoard:v(),playerShips:[],containerShips:e()}),u=Object(c.a)(p,2),d=u[0],f=u[1],m=Object(t.useState)({computerBoard:v(),computerShips:e()}),_=Object(c.a)(m,2),b=_[0],y=(_[1],Object(t.useCallback)((function(){if(a.isPlaying&&"computer"===a.activePlayer){var e=d.playerBoard.aiAttackHandler(d.playerShips),n=d.playerBoard.attackHandler(e);!1!==n?(d.playerShips[n].hitShip(),o({winner:null,isPlaying:!0,activePlayer:"computer"}),d.playerShips[n].ship.sunk&&k()):o({winner:null,isPlaying:!0,activePlayer:"user"})}})));Object(t.useEffect)((function(){if(a.isPlaying&&"computer"===a.activePlayer){var e=setTimeout((function(){y()}),1e3);return function(){clearTimeout(e)}}}),[a.activePlayer,a.isPlaying,y]);var k=function(){var e=d.playerShips.every((function(e){return!0===e.ship.sunk})),n=b.computerShips.every((function(e){return!0===e.ship.sunk}));console.log("GAME OVER HANDLER"),console.log(e),console.log(n),e&&o({winner:"computer",isPlaying:!1}),n&&o({winner:"user",isPlaying:!1})},P=d.containerShips.length>0?r.a.createElement("button",{className:h.a.flipBtn,onClick:function(){d.containerShips.forEach((function(e){e.flipShip()})),f((function(e){return Object(l.a)({},e)}))}}," FLIP"):null,x=null===a.winner?r.a.createElement("div",{className:a.isPlaying?[h.a.Container,h.a.Disable].join(" "):h.a.Container},r.a.createElement(I,{ship:d.containerShips[0]}),r.a.createElement(I,{ship:d.containerShips[1]}),r.a.createElement(I,{ship:d.containerShips[2]}),r.a.createElement(I,{ship:d.containerShips[3]}),r.a.createElement(I,{ship:d.containerShips[4]}),P):"user"===a.winner?r.a.createElement("h2",{className:h.a.winner}," All computers boats have been sunk. You won! "):"computer"===a.winner?r.a.createElement("h2",{className:h.a.winner}," All your boats have been sunk. You lost! "):null;return r.a.createElement(E.a,{backend:B.a},r.a.createElement("div",{className:h.a.gameContainer},r.a.createElement("div",{className:h.a.gameProperties},r.a.createElement("h1",null,"Battleship "),r.a.createElement("h2",null,"Player:"),r.a.createElement("h2",null,"Computer:"),r.a.createElement("div",{className:h.a.boardContainer},r.a.createElement(g,{dropped:function(e,n){return function(e,n){d.containerShips.forEach((function(i){if(i.ship.name[2]===e.id[0]&&!0===d.playerBoard.freeIndexController(n,e.id[1],i.ship.length,i.ship.orientation)){i.ship.placed=!0;var t="X"===i.ship.orientation?1:10;i.ship.firstIndex=n-e.id[1]*t,i.ship.id=d.playerShips.length,d.playerBoard.placeShips(i),f((function(e){return Object(l.a)(Object(l.a)({},e),{},{playerShips:[].concat(Object(s.a)(e.playerShips),[i]),containerShips:e.containerShips.filter((function(e){return e!==i}))})}))}}))}(e,n)},ships:d.playerShips,type:"grid",grid:d.playerBoard.getGrid()}),r.a.createElement(g,{clicked:function(e){return function(e){if(a.isPlaying&&"user"===a.activePlayer&&b.computerBoard.duplicateAttackHandler(e)){var n=b.computerBoard.attackHandler(e);!1!==n?(b.computerShips[n].hitShip(),b.computerBoard.checkSunkedShips(b.computerShips),o({winner:null,isPlaying:!0,activePlayer:"user"}),b.computerShips[n].ship.sunk&&k()):o({winner:null,isPlaying:!0,activePlayer:"computer"})}}(e)},grid:b.computerBoard.getGrid(),type:"computer",ships:b.computerShips}))),x,null===a.winner?r.a.createElement("button",{className:a.isPlaying?[h.a.startBtn,h.a.DisableBtn].join(" "):h.a.startBtn,onClick:function(){0===d.containerShips.length?(console.log("START PLAYING"),b.computerShips.forEach((function(e){for(;!0!==e.ship.placed;){var n=Math.floor(100*Math.random()),i=Math.floor(10*Math.random())<5?"X":"Y";!0===b.computerBoard.freeIndexController(n,0,e.ship.length,i)&&(e.ship.firstIndex=n,e.ship.orientation=i,e.ship.placed=!0,b.computerBoard.placeShips(e))}})),o({winner:null,isPlaying:!0,activePlayer:"user"})):console.log("PLACE ALL SHIPS")}},"Start game"):null,r.a.createElement("button",{className:h.a.resetBtn,onClick:function(){return window.location.reload(),!1}}," Reset")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},4:function(e,n,i){e.exports={gridContainer:"Board_gridContainer__1zzkP",gridItem:"Board_gridItem__2Huac",gridItemShip:"Board_gridItemShip__3rXEu",gridHittedItem:"Board_gridHittedItem__3Soft",gridItemSunkShip:"Board_gridItemSunkShip__2lqlR",sunkShip:"Board_sunkShip__3sNWI",true:"Board_true__1JjE7",gridInvisibleItem:"Board_gridInvisibleItem__muHI_"}}},[[28,1,2]]]);
//# sourceMappingURL=main.055fe8d3.chunk.js.map